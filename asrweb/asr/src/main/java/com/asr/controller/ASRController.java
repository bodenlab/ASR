package com.asr.controller;

import com.ASR;
import json.JSONObject;
import org.apache.commons.io.IOUtils;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.validation.BindingResult;
import org.springframework.web.bind.annotation.*;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.validation.Valid;
import java.io.*;
import java.nio.file.Files;
import java.nio.file.StandardCopyOption;
import java.util.zip.ZipEntry;
import java.util.zip.ZipOutputStream;

/**
 * Created by marnie on 11/4/17.
 */
@Controller
@RequestMapping(value = "/asr")
class ASRController {

    final String sessionId = "grasp" + Long.toString(System.currentTimeMillis());

    final String sessionPath = "/home/ariane/Documents/bodenlab/data/WebSessions";
    //final String sessionPath = "/Users/marnie/Documents/WebSessions/";
    //final String sessionPath = "/var/www/JavaApps/GRASP/Sessions/";

    private ASR asr;

    /**
     * Initialise the initial form in the index
     *
     * @return index html
     */
    @RequestMapping(method = RequestMethod.GET)
    public String showForm(Model model) {
        System.out.println("showForm");
        model.addAttribute("asrForm", new ASR());
        return "index";
    }

    /**
     * Submit the asr form (documenting input details, i.e. aln and tree file, etc)
     *
     * @param asrForm       ASR object
     * @param bindingResult Form result, indicating any input errors
     * @param model         com model
     * @return index with results as attributes in the model
     */
    @RequestMapping(method = RequestMethod.POST, params = "submitAsr")
    public String performReconstruction(@Valid @ModelAttribute("asrForm") ASR asrForm, BindingResult bindingResult, Model model) {
        this.asr = asrForm;

        System.out.println("submitASR");
        if (bindingResult.hasErrors()) {
            for (String err : bindingResult.getSuppressedFields())
                System.out.println(err);
            return "index";
        }

        // upload supplied files
        try {
            File sessionDir = new File(sessionPath + sessionId);
            if (!sessionDir.exists())
                sessionDir.mkdir();

            asr.setSessionDir(sessionDir.getAbsolutePath() + "/");

            asr.getAlnFile().transferTo(new File(asr.getSessionDir() + asr.getAlnFile().getOriginalFilename()));
            asr.setAlnFilepath(asr.getSessionDir() + asr.getAlnFile().getOriginalFilename());
            asr.getTreeFile().transferTo(new File(asr.getSessionDir() + asr.getTreeFile().getOriginalFilename()));
            asr.setTreeFilepath(asr.getSessionDir() + asr.getTreeFile().getOriginalFilename());

            // TODO: push exceptions to error message on view...
            ByteArrayOutputStream os = new ByteArrayOutputStream();
            PrintStream ps = new PrintStream(os);
            PrintStream old = System.err;
            System.setErr(ps);
            asr.runReconstruction();
            System.err.flush();
            System.setErr(old);
            if (!os.toString().isEmpty()) {
                model.addAttribute("error", true);
                model.addAttribute("errorMessage", os.toString());
            }
            System.out.println("err stream: " + os.toString());

            // add reconstructed newick string to send to javascript
            model.addAttribute("tree", asr.getReconstructedNewickString());

            // add msa and inferred ancestral graph
            String graphs = asr.catGraphJSONBuilder(asr.getMSAGraphJSON(), asr.getAncestralGraphJSON(asr.getInferenceType(),"root"));

            model.addAttribute("graph", graphs);

        } catch (Exception e) {
            model.addAttribute("error", true);
            model.addAttribute("errorMessage", e.getMessage());
            System.out.println("Error: " + e.getMessage());
            return "index";
        }

        // add attribute to specify to view results (i.e. to show the graph, tree, etc)
        model.addAttribute("inferenceType", asr.getInferenceType());
        model.addAttribute("results", true);

        return "index";
    }

    /**
     * Submit the asr form (documenting input details, i.e. aln and tree file, etc)
     *
     * @param asrForm ASR object
     * @param model   com model
     * @return index with results as attributes in the model
     */
    @RequestMapping(method = RequestMethod.POST, params = "test")
    public String performReconstruction(@ModelAttribute("asrForm") ASR asrForm, Model model) {

        System.out.println("test");
        this.asr = asrForm;

        // upload supplied files
        try {
            File sessionDir = new File(sessionPath + sessionId);
            if (!sessionDir.exists())
                sessionDir.mkdir();

            asr.setSessionDir(sessionDir.getAbsolutePath() + "/");
            asr.setLabel("Test");

            // copy default data to user session folder

            File alnFile = new File(Thread.currentThread().getContextClassLoader().getResource("default.aln").toURI());
            asr.setAlnFilepath(asr.getSessionDir() + "default.aln");
            Files.copy(alnFile.toPath(), (new File(asr.getAlnFilepath())).toPath(), StandardCopyOption.REPLACE_EXISTING);
            File treeFile = new File(Thread.currentThread().getContextClassLoader().getResource("default.nwk").toURI());
            asr.setTreeFilepath(asr.getSessionDir() + "default.nwk");
            Files.copy(treeFile.toPath(), (new File(asr.getTreeFilepath())).toPath(), StandardCopyOption.REPLACE_EXISTING);

            // TODO: push exceptions to error message on view...
            asr.runReconstruction();

            // add reconstructed newick string to send to javascript
            model.addAttribute("tree", asr.getReconstructedNewickString());

            //JSONObject msa = new JSONObject("{\"nodes\":[{\"x\":0,\"y\":0,\"id\":0,\"label\":\"M\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"M\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"M\",\"value\":11}]}},{\"x\":1,\"y\":0,\"id\":1,\"label\":\"SHGD\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"H\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":9}]}},{\"x\":2,\"y\":0,\"id\":2,\"label\":\"ILF\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":70}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":1}]}},{\"x\":3,\"y\":2,\"id\":3,\"label\":\"LPQK\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":3}]}},{\"x\":4,\"y\":1,\"id\":4,\"label\":\"P\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":5,\"y\":1,\"id\":5,\"label\":\"R\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":11}]}},{\"x\":6,\"y\":1,\"id\":6,\"label\":\"G\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"G\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"G\",\"value\":11}]}},{\"x\":7,\"y\":1,\"id\":7,\"label\":\"G\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"G\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"G\",\"value\":11}]}},{\"x\":8,\"y\":1,\"id\":8,\"label\":\"W\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"W\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"W\",\"value\":11}]}},{\"x\":9,\"y\":1,\"id\":9,\"label\":\"D\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":13}]}},{\"x\":10,\"y\":1,\"id\":10,\"label\":\"D\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":13}]}},{\"x\":11,\"y\":1,\"id\":11,\"label\":\"D\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":13}]}},{\"x\":12,\"y\":1,\"id\":12,\"label\":\"D\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":13}]}},{\"x\":13,\"y\":1,\"id\":13,\"label\":\"D\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":13}]}},{\"x\":14,\"y\":0,\"id\":14,\"label\":\"R\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":7}]}},{\"x\":15,\"y\":0,\"id\":15,\"label\":\"V\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":7}]}},{\"x\":16,\"y\":0,\"id\":16,\"label\":\"A\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":7}]}},{\"x\":17,\"y\":0,\"id\":17,\"label\":\"V\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":7}]}},{\"x\":18,\"y\":0,\"id\":18,\"label\":\"V\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":7}]}},{\"x\":19,\"y\":1,\"id\":19,\"label\":\"S\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":6}]}},{\"x\":20,\"y\":1,\"id\":20,\"label\":\"S\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":6}]}},{\"x\":21,\"y\":1,\"id\":21,\"label\":\"S\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":6}]}},{\"x\":22,\"y\":1,\"id\":22,\"label\":\"S\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":6}]}},{\"x\":23,\"y\":1,\"id\":23,\"label\":\"M\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"M\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"M\",\"value\":6}]}},{\"x\":24,\"y\":1,\"id\":24,\"label\":\"TLSQEPA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":5}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":25,\"y\":1,\"id\":25,\"label\":\"PQGNS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":60}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":12}]}},{\"x\":26,\"y\":1,\"id\":26,\"label\":\"GQR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":27,\"y\":1,\"id\":27,\"label\":\"TVIKHREFS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":1}]}},{\"x\":28,\"y\":1,\"id\":28,\"label\":\"YFSA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":29,\"y\":1,\"id\":29,\"label\":\"NRWKQAFLVT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":30,\"y\":1,\"id\":30,\"label\":\"ILV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":70}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":2}]}},{\"x\":31,\"y\":1,\"id\":31,\"label\":\"TRIKVE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":10}]}},{\"x\":32,\"y\":1,\"id\":32,\"label\":\"NSCTY\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Y\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":3}]}},{\"x\":33,\"y\":1,\"id\":33,\"label\":\"VSAHLKF\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":8}]}},{\"x\":34,\"y\":1,\"id\":34,\"label\":\"AKRHESMGTL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":10}]}},{\"x\":35,\"y\":2,\"id\":35,\"label\":\"YFWATIHGS\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":36,\"y\":1,\"id\":36,\"label\":\"TPSDNG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":10}]}},{\"x\":37,\"y\":1,\"id\":37,\"label\":\"NGDWTKH\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":8}]}},{\"x\":38,\"y\":1,\"id\":38,\"label\":\"RQKTNLCI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":6}]}},{\"x\":39,\"y\":1,\"id\":39,\"label\":\"LVMAIYFNK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":40,\"y\":1,\"id\":40,\"label\":\"IFLMV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":4}]}},{\"x\":41,\"y\":1,\"id\":41,\"label\":\"DEKI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":25}]}},{\"x\":42,\"y\":1,\"id\":42,\"label\":\"LEAVIF\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":43,\"y\":1,\"id\":43,\"label\":\"TSKINRCPAEV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":44,\"y\":1,\"id\":44,\"label\":\"GEDT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"T\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":2}]}},{\"x\":45,\"y\":1,\"id\":45,\"label\":\"SGAVDKY\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":4}]}},{\"x\":46,\"y\":1,\"id\":46,\"label\":\"NGKDSTI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":2}]}},{\"x\":47,\"y\":1,\"id\":47,\"label\":\"PITQKAVSDR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":6}]}},{\"x\":48,\"y\":1,\"id\":48,\"label\":\"ANEDSQTRKG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":9}]}},{\"x\":49,\"y\":1,\"id\":49,\"label\":\"EPNADG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":8}]}},{\"x\":50,\"y\":1,\"id\":50,\"label\":\"NGDISKEALR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":51,\"y\":1,\"id\":51,\"label\":\"TDRKHGNSV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":2}]}},{\"x\":52,\"y\":1,\"id\":52,\"label\":\"LPRSIVTKQNA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":53,\"y\":1,\"id\":53,\"label\":\"IVL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":10}]}},{\"x\":54,\"y\":1,\"id\":54,\"label\":\"IVLACHQ\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":4}]}},{\"x\":55,\"y\":1,\"id\":55,\"label\":\"GNQALSV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":56,\"y\":1,\"id\":56,\"label\":\"HYFVWLQNA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":57,\"y\":1,\"id\":57,\"label\":\"HADNPETQSI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":6}]}},{\"x\":58,\"y\":1,\"id\":58,\"label\":\"LNQSDRWYAFK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":59,\"y\":1,\"id\":59,\"label\":\"NHKTDAS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":60,\"y\":1,\"id\":60,\"label\":\"KSDYGNTP\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":61,\"y\":1,\"id\":61,\"label\":\"TGAQWDVR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":62,\"y\":1,\"id\":62,\"label\":\"PFTA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":60}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":4}]}},{\"x\":63,\"y\":1,\"id\":63,\"label\":\"SNEAT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":64,\"y\":1,\"id\":64,\"label\":\"GQN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":65,\"y\":1,\"id\":65,\"label\":\"PYSVTFG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":5}]}},{\"x\":66,\"y\":1,\"id\":66,\"label\":\"GQLEPSDTAFKN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":3}]}},{\"x\":67,\"y\":1,\"id\":67,\"label\":\"NSA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":68,\"y\":0,\"id\":68,\"label\":\"QMVE\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":70}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":24}]}},{\"x\":69,\"y\":0,\"id\":69,\"label\":\"QLKRHYINSF\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":8}]}},{\"x\":70,\"y\":0,\"id\":70,\"label\":\"WYF\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Y\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":3}]}},{\"x\":71,\"y\":0,\"id\":71,\"label\":\"TLCIDEKYR\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":2}]}},{\"x\":72,\"y\":0,\"id\":72,\"label\":\"LMVFIA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":73,\"y\":0,\"id\":73,\"label\":\"VQEISTKL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":8}]}},{\"x\":74,\"y\":0,\"id\":74,\"label\":\"QVRKDESLPH\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":75,\"y\":1,\"id\":75,\"label\":\"LVIASNKEDT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":9}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":76,\"y\":0,\"id\":76,\"label\":\"PDEFQGNSKA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":8}]}},{\"x\":77,\"y\":0,\"id\":77,\"label\":\"HATGDSQPENL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":78,\"y\":1,\"id\":78,\"label\":\"N\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"N\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"N\",\"value\":3}]}},{\"x\":79,\"y\":1,\"id\":79,\"label\":\"G\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"G\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"G\",\"value\":1}]}},{\"x\":80,\"y\":1,\"id\":80,\"label\":\"TSRAPLGEQV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":81,\"y\":1,\"id\":81,\"label\":\"TNDSEGYRK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":1}]}},{\"x\":82,\"y\":0,\"id\":82,\"label\":\"IKTGQWAEVYL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":3}]}},{\"x\":83,\"y\":1,\"id\":83,\"label\":\"YILWFR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":3}]}},{\"x\":84,\"y\":1,\"id\":84,\"label\":\"TVLHEIS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":7}]}},{\"x\":85,\"y\":1,\"id\":85,\"label\":\"MRILVCYKF\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":4}]}},{\"x\":86,\"y\":1,\"id\":86,\"label\":\"QLRKATIGS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":4}]}},{\"x\":87,\"y\":1,\"id\":87,\"label\":\"AISNGKQP\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":88,\"y\":1,\"id\":88,\"label\":\"VNAKMTLIDQE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":7}]}},{\"x\":89,\"y\":1,\"id\":89,\"label\":\"NVHQGALSKRDE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":90,\"y\":1,\"id\":90,\"label\":\"PASFTGKED\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":4}]}},{\"x\":91,\"y\":1,\"id\":91,\"label\":\"K\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"K\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"K\",\"value\":8}]}},{\"x\":92,\"y\":1,\"id\":92,\"label\":\"F\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"F\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":6}]}},{\"x\":93,\"y\":1,\"id\":93,\"label\":\"KN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"N\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"K\",\"value\":5}]}},{\"x\":94,\"y\":1,\"id\":94,\"label\":\"NP\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":95,\"y\":1,\"id\":95,\"label\":\"I\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"I\",\"value\":6}]}},{\"x\":96,\"y\":1,\"id\":96,\"label\":\"DG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":80}]},\"seq\":{\"chars\":[{\"label\":\"D\",\"value\":5}]}},{\"x\":97,\"y\":1,\"id\":97,\"label\":\"QSNGKDETR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":3}]}},{\"x\":98,\"y\":1,\"id\":98,\"label\":\"SGLQKIVANRT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":99,\"y\":1,\"id\":99,\"label\":\"YTVFNCAML\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":5}]}},{\"x\":100,\"y\":1,\"id\":100,\"label\":\"VFLIAM\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":6}]}},{\"x\":101,\"y\":1,\"id\":101,\"label\":\"RADNHSGT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":6}]}},{\"x\":102,\"y\":1,\"id\":102,\"label\":\"VQLAPIYM\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":103,\"y\":1,\"id\":103,\"label\":\"RGHAEDSPK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":104,\"y\":1,\"id\":104,\"label\":\"DAGESQRN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":105,\"y\":1,\"id\":105,\"label\":\"DGEHTLAPS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":106,\"y\":0,\"id\":106,\"label\":\"NSLTYKRAGW\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":107,\"y\":1,\"id\":107,\"label\":\"LQSGEHIVATC\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":8}]}},{\"x\":108,\"y\":1,\"id\":108,\"label\":\"EVAPSYFKTGL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":109,\"y\":1,\"id\":109,\"label\":\"Q\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":110,\"y\":1,\"id\":110,\"label\":\"P\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":111,\"y\":1,\"id\":111,\"label\":\"A\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":112,\"y\":1,\"id\":112,\"label\":\"DA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":113,\"y\":1,\"id\":113,\"label\":\"NSI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":1}]}},{\"x\":114,\"y\":1,\"id\":114,\"label\":\"EGRSHT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":1}]}},{\"x\":115,\"y\":1,\"id\":115,\"label\":\"DGNPIVA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":4}]}},{\"x\":116,\"y\":2,\"id\":116,\"label\":\"GPD\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":3}]}},{\"x\":117,\"y\":1,\"id\":117,\"label\":\"ATVYQS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":7}]}},{\"x\":118,\"y\":1,\"id\":118,\"label\":\"AGPSREKLTQ\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":4}]}},{\"x\":119,\"y\":1,\"id\":119,\"label\":\"LMVIA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":120,\"y\":1,\"id\":120,\"label\":\"VQTIAMHE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":4}]}},{\"x\":121,\"y\":1,\"id\":121,\"label\":\"GALIVT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":6}]}},{\"x\":122,\"y\":1,\"id\":122,\"label\":\"SWGARQNY\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":123,\"y\":2,\"id\":123,\"label\":\"Q\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":124,\"y\":1,\"id\":124,\"label\":\"GTK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"K\",\"value\":9}]},\"seq\":{\"chars\":[{\"label\":\"T\",\"value\":4}]}},{\"x\":125,\"y\":1,\"id\":125,\"label\":\"NSGEPIC\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":126,\"y\":1,\"id\":126,\"label\":\"PHNDS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":5}]}},{\"x\":127,\"y\":1,\"id\":127,\"label\":\"AGDN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":128,\"y\":1,\"id\":128,\"label\":\"QGDEPFSNVT\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":9}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":129,\"y\":1,\"id\":129,\"label\":\"QSRVDNKETFYHA\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":130,\"y\":1,\"id\":130,\"label\":\"PANIRYLGS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":131,\"y\":1,\"id\":131,\"label\":\"TAQFVSYEM\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":4}]}},{\"x\":132,\"y\":1,\"id\":132,\"label\":\"PLQGATSRYFEK\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":133,\"y\":1,\"id\":133,\"label\":\"VFWMLI\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":2}]}},{\"x\":134,\"y\":1,\"id\":134,\"label\":\"SKRTDYHVIL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"R\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":1}]}},{\"x\":135,\"y\":1,\"id\":135,\"label\":\"IVLF\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":10}]}},{\"x\":136,\"y\":1,\"id\":136,\"label\":\"EVKQDYWAFN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":137,\"y\":1,\"id\":137,\"label\":\"SPYQEHAGN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":138,\"y\":1,\"id\":138,\"label\":\"ARSEDQVNIL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":12}]}},{\"x\":139,\"y\":1,\"id\":139,\"label\":\"GNKTQPEDS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":140,\"y\":1,\"id\":140,\"label\":\"L\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"L\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"L\",\"value\":1}]}},{\"x\":141,\"y\":1,\"id\":141,\"label\":\"G\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"G\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"G\",\"value\":1}]}},{\"x\":142,\"y\":1,\"id\":142,\"label\":\"V\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":1}]}},{\"x\":143,\"y\":1,\"id\":143,\"label\":\"Y\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Y\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"Y\",\"value\":1}]}},{\"x\":144,\"y\":1,\"id\":144,\"label\":\"T\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"T\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"T\",\"value\":1}]}},{\"x\":145,\"y\":1,\"id\":145,\"label\":\"ANSPTCGHV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":5}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":146,\"y\":2,\"id\":146,\"label\":\"Q\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":147,\"y\":1,\"id\":147,\"label\":\"NAETG\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":148,\"y\":1,\"id\":148,\"label\":\"KDHRN\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"H\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"R\",\"value\":1}]}},{\"x\":149,\"y\":1,\"id\":149,\"label\":\"SLMPEKNDGTC\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":150,\"y\":0,\"id\":150,\"label\":\"GTNDQAE\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":151,\"y\":0,\"id\":151,\"label\":\"QELKHTVYRDSF\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":3}]}},{\"x\":152,\"y\":0,\"id\":152,\"label\":\"FYVLAWRSHG\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":153,\"y\":0,\"id\":153,\"label\":\"RVTAYKWSQILFP\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":154,\"y\":0,\"id\":154,\"label\":\"IFLVA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":155,\"y\":0,\"id\":155,\"label\":\"KQVSYFLHGPNTA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":3}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":156,\"y\":2,\"id\":156,\"label\":\"ITNVFWALKH\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":6}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":157,\"y\":0,\"id\":157,\"label\":\"PTALHIN\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":13}]}},{\"x\":158,\"y\":0,\"id\":158,\"label\":\"NDAGEYR\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":5}]}},{\"x\":159,\"y\":0,\"id\":159,\"label\":\"LGSTFVQMNP\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":3}]}},{\"x\":160,\"y\":1,\"id\":160,\"label\":\"GQSEKNHD\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":5}]}},{\"x\":161,\"y\":1,\"id\":161,\"label\":\"LTFRKGAM\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":162,\"y\":1,\"id\":162,\"label\":\"P\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":3}]}},{\"x\":163,\"y\":1,\"id\":163,\"label\":\"I\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"I\",\"value\":3}]}},{\"x\":164,\"y\":0,\"id\":164,\"label\":\"ANTSVCFR\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":14}]}},{\"x\":165,\"y\":0,\"id\":165,\"label\":\"LCVFA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":166,\"y\":0,\"id\":166,\"label\":\"TSDLAE\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":4}]}},{\"x\":167,\"y\":2,\"id\":167,\"label\":\"LHFPAV\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":168,\"y\":0,\"id\":168,\"label\":\"PANVLSTFK\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":5}]}},{\"x\":169,\"y\":0,\"id\":169,\"label\":\"SNEDMG\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":4}]}},{\"x\":170,\"y\":0,\"id\":170,\"label\":\"DAFHNGV\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":5}]}},{\"x\":171,\"y\":0,\"id\":171,\"label\":\"ANDGKQRSPL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":172,\"y\":2,\"id\":172,\"label\":\"SN\",\"class\":\"\",\"lane\":2,\"graph\":{\"bars\":[{\"x_label\":\"N\",\"value\":50}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":2}]}},{\"x\":173,\"y\":1,\"id\":173,\"label\":\"QTSVP\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":9}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":174,\"y\":1,\"id\":174,\"label\":\"TGEAR\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":175,\"y\":0,\"id\":175,\"label\":\"NSEVDQA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":176,\"y\":1,\"id\":176,\"label\":\"SFDGENWTL\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":6}]}},{\"x\":177,\"y\":1,\"id\":177,\"label\":\"TGSINE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":1}]}},{\"x\":178,\"y\":1,\"id\":178,\"label\":\"PQSTRLDE\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":11}]}},{\"x\":179,\"y\":1,\"id\":179,\"label\":\"IVKDLFHS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"S\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":2}]}},{\"x\":180,\"y\":0,\"id\":180,\"label\":\"VTDHLIA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":181,\"y\":0,\"id\":181,\"label\":\"LTIQPEV\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":182,\"y\":0,\"id\":182,\"label\":\"GQADFLWIPREK\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":183,\"y\":0,\"id\":183,\"label\":\"EKTDWNSPQRYL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"D\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":2}]}},{\"x\":184,\"y\":0,\"id\":184,\"label\":\"VPKSRGWQLCT\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":185,\"y\":0,\"id\":185,\"label\":\"DANWTVQRIS\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":186,\"y\":1,\"id\":186,\"label\":\"EAWDGTPS\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":5}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":187,\"y\":1,\"id\":187,\"label\":\"ST\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"T\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"S\",\"value\":2}]}},{\"x\":188,\"y\":1,\"id\":188,\"label\":\"LIV\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":1}]}},{\"x\":189,\"y\":1,\"id\":189,\"label\":\"SDQ\",\"class\":\"\",\"lane\":1,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":30}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":190,\"y\":0,\"id\":190,\"label\":\"TNDSEQGAP\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":5}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":191,\"y\":0,\"id\":191,\"label\":\"SDGANEKT\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":10}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":3}]}},{\"x\":192,\"y\":0,\"id\":192,\"label\":\"TSPDKREQNCAL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":1}]}},{\"x\":193,\"y\":0,\"id\":193,\"label\":\"NSKQHRDCLA\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":8}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":194,\"y\":0,\"id\":194,\"label\":\"QS\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":24}]}},{\"x\":195,\"y\":0,\"id\":195,\"label\":\"LGIQVKMHR\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":1}]}},{\"x\":196,\"y\":0,\"id\":196,\"label\":\"WFY\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Y\",\"value\":4}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":3}]}},{\"x\":197,\"y\":0,\"id\":197,\"label\":\"AITRFKYVSQ\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":4}]}},{\"x\":198,\"y\":0,\"id\":198,\"label\":\"FL\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"L\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"F\",\"value\":19}]}},{\"x\":199,\"y\":0,\"id\":199,\"label\":\"ECQDTR\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"Q\",\"value\":9}]},\"seq\":{\"chars\":[{\"label\":\"Q\",\"value\":2}]}},{\"x\":200,\"y\":0,\"id\":200,\"label\":\"SPQKRE\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"P\",\"value\":40}]},\"seq\":{\"chars\":[{\"label\":\"P\",\"value\":6}]}},{\"x\":201,\"y\":0,\"id\":201,\"label\":\"VLI\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"I\",\"value\":7}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":13}]}},{\"x\":202,\"y\":0,\"id\":202,\"label\":\"SEAD\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":20}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":1}]}},{\"x\":203,\"y\":0,\"id\":203,\"label\":\"A\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"A\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"A\",\"value\":2}]}},{\"x\":204,\"y\":0,\"id\":204,\"label\":\"V\",\"class\":\"\",\"lane\":0,\"graph\":{\"bars\":[{\"x_label\":\"V\",\"value\":100}]},\"seq\":{\"chars\":[{\"label\":\"V\",\"value\":2}]}}],\"max_depth\":2,\"edges\":{\"edges_184:185\":{\"y1\":0,\"x1\":184,\"y2\":0,\"weight\":67,\"from\":184,\"x2\":185,\"to\":185},\"edges_200:201\":{\"y1\":0,\"x1\":200,\"y2\":0,\"weight\":40,\"from\":200,\"x2\":201,\"to\":201},\"edges_89:90\":{\"y1\":1,\"x1\":89,\"y2\":1,\"weight\":83,\"from\":89,\"x2\":90,\"to\":90},\"edges_152:153\":{\"y1\":0,\"x1\":152,\"y2\":0,\"weight\":86,\"from\":152,\"x2\":153,\"to\":153},\"edges_78:79\":{\"y1\":1,\"x1\":78,\"y2\":1,\"weight\":2,\"from\":78,\"x2\":79,\"to\":79},\"edges_11:12\":{\"y1\":1,\"x1\":11,\"y2\":1,\"weight\":35,\"from\":11,\"x2\":12,\"to\":12},\"edges_84:85\":{\"y1\":1,\"x1\":84,\"y2\":1,\"weight\":83,\"from\":84,\"x2\":85,\"to\":85},\"edges_140:141\":{\"y1\":1,\"x1\":140,\"y2\":1,\"weight\":2,\"from\":140,\"x2\":141,\"to\":141},\"edges_67:68\":{\"y1\":1,\"x1\":67,\"y2\":0,\"weight\":89,\"from\":67,\"x2\":68,\"to\":68},\"edges_100:101\":{\"y1\":1,\"x1\":100,\"y2\":1,\"weight\":86,\"from\":100,\"x2\":101,\"to\":101},\"edges_95:96\":{\"y1\":1,\"x1\":95,\"y2\":1,\"weight\":16,\"from\":95,\"x2\":96,\"to\":96},\"edges_172:173\":{\"y1\":2,\"x1\":172,\"y2\":1,\"weight\":10,\"from\":172,\"x2\":173,\"to\":173},\"edges_160:164\":{\"y1\":1,\"x1\":160,\"y2\":0,\"weight\":5,\"from\":160,\"x2\":164,\"to\":164},\"edges_192:193\":{\"y1\":0,\"x1\":192,\"y2\":0,\"weight\":67,\"from\":192,\"x2\":193,\"to\":193},\"edges_160:161\":{\"y1\":1,\"x1\":160,\"y2\":1,\"weight\":64,\"from\":160,\"x2\":161,\"to\":161},\"edges_56:57\":{\"y1\":1,\"x1\":56,\"y2\":1,\"weight\":81,\"from\":56,\"x2\":57,\"to\":57},\"edges_144:145\":{\"y1\":1,\"x1\":144,\"y2\":1,\"weight\":2,\"from\":144,\"x2\":145,\"to\":145},\"edges_112:113\":{\"y1\":1,\"x1\":112,\"y2\":1,\"weight\":5,\"from\":112,\"x2\":113,\"to\":113},\"edges_33:34\":{\"y1\":1,\"x1\":33,\"y2\":1,\"weight\":72,\"from\":33,\"x2\":34,\"to\":34},\"edges_119:120\":{\"y1\":1,\"x1\":119,\"y2\":1,\"weight\":70,\"from\":119,\"x2\":120,\"to\":120},\"edges_180:181\":{\"y1\":0,\"x1\":180,\"y2\":0,\"weight\":72,\"from\":180,\"x2\":181,\"to\":181},\"edges_188:189\":{\"y1\":1,\"x1\":188,\"y2\":1,\"weight\":8,\"from\":188,\"x2\":189,\"to\":189},\"edges_90:97\":{\"y1\":1,\"x1\":90,\"y2\":1,\"weight\":62,\"from\":90,\"x2\":97,\"to\":97},\"edges_156:157\":{\"y1\":2,\"x1\":156,\"y2\":0,\"weight\":70,\"from\":156,\"x2\":157,\"to\":157},\"edges_90:99\":{\"y1\":1,\"x1\":90,\"y2\":1,\"weight\":2,\"from\":90,\"x2\":99,\"to\":99},\"edges_124:125\":{\"y1\":1,\"x1\":124,\"y2\":1,\"weight\":29,\"from\":124,\"x2\":125,\"to\":125},\"edges_22:23\":{\"y1\":1,\"x1\":22,\"y2\":1,\"weight\":16,\"from\":22,\"x2\":23,\"to\":23},\"edges_45:46\":{\"y1\":1,\"x1\":45,\"y2\":1,\"weight\":70,\"from\":45,\"x2\":46,\"to\":46},\"edges_7:8\":{\"y1\":1,\"x1\":7,\"y2\":1,\"weight\":29,\"from\":7,\"x2\":8,\"to\":8},\"edges_90:91\":{\"y1\":1,\"x1\":90,\"y2\":1,\"weight\":21,\"from\":90,\"x2\":91,\"to\":91},\"edges_159:164\":{\"y1\":0,\"x1\":159,\"y2\":0,\"weight\":2,\"from\":159,\"x2\":164,\"to\":164},\"edges_72:73\":{\"y1\":0,\"x1\":72,\"y2\":0,\"weight\":91,\"from\":72,\"x2\":73,\"to\":73},\"edges_55:56\":{\"y1\":1,\"x1\":55,\"y2\":1,\"weight\":81,\"from\":55,\"x2\":56,\"to\":56},\"edges_34:35\":{\"y1\":1,\"x1\":34,\"y2\":2,\"weight\":59,\"from\":34,\"x2\":35,\"to\":35},\"edges_34:36\":{\"y1\":1,\"x1\":34,\"y2\":1,\"weight\":18,\"from\":34,\"x2\":36,\"to\":36},\"edges_168:169\":{\"y1\":0,\"x1\":168,\"y2\":0,\"weight\":72,\"from\":168,\"x2\":169,\"to\":169},\"edges_17:18\":{\"y1\":0,\"x1\":17,\"y2\":0,\"weight\":18,\"from\":17,\"x2\":18,\"to\":18},\"edges_49:50\":{\"y1\":1,\"x1\":49,\"y2\":1,\"weight\":70,\"from\":49,\"x2\":50,\"to\":50},\"edges_139:147\":{\"y1\":1,\"x1\":139,\"y2\":1,\"weight\":5,\"from\":139,\"x2\":147,\"to\":147},\"edges_61:62\":{\"y1\":1,\"x1\":61,\"y2\":1,\"weight\":18,\"from\":61,\"x2\":62,\"to\":62},\"edges_139:148\":{\"y1\":1,\"x1\":139,\"y2\":1,\"weight\":2,\"from\":139,\"x2\":148,\"to\":148},\"edges_139:149\":{\"y1\":1,\"x1\":139,\"y2\":1,\"weight\":10,\"from\":139,\"x2\":149,\"to\":149},\"edges_179:180\":{\"y1\":1,\"x1\":179,\"y2\":0,\"weight\":70,\"from\":179,\"x2\":180,\"to\":180},\"edges_61:66\":{\"y1\":1,\"x1\":61,\"y2\":1,\"weight\":48,\"from\":61,\"x2\":66,\"to\":66},\"edges_61:65\":{\"y1\":1,\"x1\":61,\"y2\":1,\"weight\":13,\"from\":61,\"x2\":65,\"to\":65},\"edges_148:149\":{\"y1\":1,\"x1\":148,\"y2\":1,\"weight\":27,\"from\":148,\"x2\":149,\"to\":149},\"edges_139:140\":{\"y1\":1,\"x1\":139,\"y2\":1,\"weight\":2,\"from\":139,\"x2\":140,\"to\":140},\"edges_44:45\":{\"y1\":1,\"x1\":44,\"y2\":1,\"weight\":70,\"from\":44,\"x2\":45,\"to\":45},\"edges_187:188\":{\"y1\":1,\"x1\":187,\"y2\":1,\"weight\":8,\"from\":187,\"x2\":188,\"to\":188},\"edges_39:40\":{\"y1\":1,\"x1\":39,\"y2\":1,\"weight\":81,\"from\":39,\"x2\":40,\"to\":40},\"edges_104:105\":{\"y1\":1,\"x1\":104,\"y2\":1,\"weight\":75,\"from\":104,\"x2\":105,\"to\":105},\"edges_44:48\":{\"y1\":1,\"x1\":44,\"y2\":1,\"weight\":8,\"from\":44,\"x2\":48,\"to\":48},\"edges_77:80\":{\"y1\":0,\"x1\":77,\"y2\":1,\"weight\":62,\"from\":77,\"x2\":80,\"to\":80},\"edges_23:27\":{\"y1\":1,\"x1\":23,\"y2\":1,\"weight\":5,\"from\":23,\"x2\":27,\"to\":27},\"edges_77:81\":{\"y1\":0,\"x1\":77,\"y2\":1,\"weight\":10,\"from\":77,\"x2\":81,\"to\":81},\"edges_115:116\":{\"y1\":1,\"x1\":115,\"y2\":2,\"weight\":62,\"from\":115,\"x2\":116,\"to\":116},\"edges_139:145\":{\"y1\":1,\"x1\":139,\"y2\":1,\"weight\":51,\"from\":139,\"x2\":145,\"to\":145},\"edges_77:82\":{\"y1\":0,\"x1\":77,\"y2\":0,\"weight\":2,\"from\":77,\"x2\":82,\"to\":82},\"edges_115:117\":{\"y1\":1,\"x1\":115,\"y2\":1,\"weight\":5,\"from\":115,\"x2\":117,\"to\":117},\"edges_176:177\":{\"y1\":1,\"x1\":176,\"y2\":1,\"weight\":67,\"from\":176,\"x2\":177,\"to\":177},\"edges_50:51\":{\"y1\":1,\"x1\":50,\"y2\":1,\"weight\":81,\"from\":50,\"x2\":51,\"to\":51},\"edges_77:78\":{\"y1\":0,\"x1\":77,\"y2\":1,\"weight\":8,\"from\":77,\"x2\":78,\"to\":78},\"edges_143:144\":{\"y1\":1,\"x1\":143,\"y2\":1,\"weight\":2,\"from\":143,\"x2\":144,\"to\":144},\"edges_132:133\":{\"y1\":1,\"x1\":132,\"y2\":1,\"weight\":83,\"from\":132,\"x2\":133,\"to\":133},\"edges_12:13\":{\"y1\":1,\"x1\":12,\"y2\":1,\"weight\":35,\"from\":12,\"x2\":13,\"to\":13},\"edges_196:197\":{\"y1\":0,\"x1\":196,\"y2\":0,\"weight\":67,\"from\":196,\"x2\":197,\"to\":197},\"edges_85:86\":{\"y1\":1,\"x1\":85,\"y2\":1,\"weight\":83,\"from\":85,\"x2\":86,\"to\":86},\"edges_104:113\":{\"y1\":1,\"x1\":104,\"y2\":1,\"weight\":8,\"from\":104,\"x2\":113,\"to\":113},\"edges_66:67\":{\"y1\":1,\"x1\":66,\"y2\":1,\"weight\":89,\"from\":66,\"x2\":67,\"to\":67},\"edges_163:164\":{\"y1\":1,\"x1\":163,\"y2\":0,\"weight\":8,\"from\":163,\"x2\":164,\"to\":164},\"edges_128:129\":{\"y1\":1,\"x1\":128,\"y2\":1,\"weight\":62,\"from\":128,\"x2\":129,\"to\":129},\"edges_28:29\":{\"y1\":1,\"x1\":28,\"y2\":1,\"weight\":70,\"from\":28,\"x2\":29,\"to\":29},\"edges_159:160\":{\"y1\":0,\"x1\":159,\"y2\":1,\"weight\":70,\"from\":159,\"x2\":160,\"to\":160},\"edges_96:97\":{\"y1\":1,\"x1\":96,\"y2\":1,\"weight\":16,\"from\":96,\"x2\":97,\"to\":97},\"edges_141:142\":{\"y1\":1,\"x1\":141,\"y2\":1,\"weight\":2,\"from\":141,\"x2\":142,\"to\":142},\"edges_175:180\":{\"y1\":0,\"x1\":175,\"y2\":0,\"weight\":2,\"from\":175,\"x2\":180,\"to\":180},\"edges_32:33\":{\"y1\":1,\"x1\":32,\"y2\":1,\"weight\":72,\"from\":32,\"x2\":33,\"to\":33},\"edges_15:16\":{\"y1\":0,\"x1\":15,\"y2\":0,\"weight\":18,\"from\":15,\"x2\":16,\"to\":16},\"edges_118:119\":{\"y1\":1,\"x1\":118,\"y2\":1,\"weight\":70,\"from\":118,\"x2\":119,\"to\":119},\"edges_121:127\":{\"y1\":1,\"x1\":121,\"y2\":1,\"weight\":2,\"from\":121,\"x2\":127,\"to\":127},\"edges_193:194\":{\"y1\":0,\"x1\":193,\"y2\":0,\"weight\":67,\"from\":193,\"x2\":194,\"to\":194},\"edges_21:22\":{\"y1\":1,\"x1\":21,\"y2\":1,\"weight\":16,\"from\":21,\"x2\":22,\"to\":22},\"edges_18:84\":{\"y1\":0,\"x1\":18,\"y2\":1,\"weight\":2,\"from\":18,\"x2\":84,\"to\":84},\"edges_91:97\":{\"y1\":1,\"x1\":91,\"y2\":1,\"weight\":5,\"from\":91,\"x2\":97,\"to\":97},\"edges_108:109\":{\"y1\":1,\"x1\":108,\"y2\":1,\"weight\":2,\"from\":108,\"x2\":109,\"to\":109},\"edges_91:92\":{\"y1\":1,\"x1\":91,\"y2\":1,\"weight\":16,\"from\":91,\"x2\":92,\"to\":92},\"edges_108:115\":{\"y1\":1,\"x1\":108,\"y2\":1,\"weight\":37,\"from\":108,\"x2\":115,\"to\":115},\"edges_108:114\":{\"y1\":1,\"x1\":108,\"y2\":1,\"weight\":5,\"from\":108,\"x2\":114,\"to\":114},\"edges_171:176\":{\"y1\":0,\"x1\":171,\"y2\":1,\"weight\":2,\"from\":171,\"x2\":176,\"to\":176},\"edges_71:72\":{\"y1\":0,\"x1\":71,\"y2\":0,\"weight\":91,\"from\":71,\"x2\":72,\"to\":72},\"edges_108:112\":{\"y1\":1,\"x1\":108,\"y2\":1,\"weight\":2,\"from\":108,\"x2\":112,\"to\":112},\"edges_203:204\":{\"y1\":0,\"x1\":203,\"y2\":0,\"weight\":5,\"from\":203,\"x2\":204,\"to\":204},\"edges_37:38\":{\"y1\":1,\"x1\":37,\"y2\":1,\"weight\":81,\"from\":37,\"x2\":38,\"to\":38},\"edges_82:87\":{\"y1\":0,\"x1\":82,\"y2\":1,\"weight\":2,\"from\":82,\"x2\":87,\"to\":87},\"edges_171:174\":{\"y1\":0,\"x1\":171,\"y2\":1,\"weight\":2,\"from\":171,\"x2\":174,\"to\":174},\"edges_82:83\":{\"y1\":0,\"x1\":82,\"y2\":1,\"weight\":78,\"from\":82,\"x2\":83,\"to\":83},\"edges_171:175\":{\"y1\":0,\"x1\":171,\"y2\":0,\"weight\":37,\"from\":171,\"x2\":175,\"to\":175},\"edges_10:11\":{\"y1\":1,\"x1\":10,\"y2\":1,\"weight\":35,\"from\":10,\"x2\":11,\"to\":11},\"edges_171:172\":{\"y1\":0,\"x1\":171,\"y2\":2,\"weight\":10,\"from\":171,\"x2\":172,\"to\":172},\"edges_171:173\":{\"y1\":0,\"x1\":171,\"y2\":1,\"weight\":18,\"from\":171,\"x2\":173,\"to\":173},\"edges_60:61\":{\"y1\":1,\"x1\":60,\"y2\":1,\"weight\":78,\"from\":60,\"x2\":61,\"to\":61},\"edges_8:24\":{\"y1\":1,\"x1\":8,\"y2\":1,\"weight\":24,\"from\":8,\"x2\":24,\"to\":24},\"edges_5:6\":{\"y1\":1,\"x1\":5,\"y2\":1,\"weight\":29,\"from\":5,\"x2\":6,\"to\":6},\"edges_76:80\":{\"y1\":0,\"x1\":76,\"y2\":1,\"weight\":2,\"from\":76,\"x2\":80,\"to\":80},\"edges_8:26\":{\"y1\":1,\"x1\":8,\"y2\":1,\"weight\":2,\"from\":8,\"x2\":26,\"to\":26},\"edges_8:25\":{\"y1\":1,\"x1\":8,\"y2\":1,\"weight\":2,\"from\":8,\"x2\":25,\"to\":25},\"edges_135:136\":{\"y1\":1,\"x1\":135,\"y2\":1,\"weight\":81,\"from\":135,\"x2\":136,\"to\":136},\"edges_113:114\":{\"y1\":1,\"x1\":113,\"y2\":1,\"weight\":13,\"from\":113,\"x2\":114,\"to\":114},\"edges_181:182\":{\"y1\":0,\"x1\":181,\"y2\":0,\"weight\":72,\"from\":181,\"x2\":182,\"to\":182},\"edges_26:27\":{\"y1\":1,\"x1\":26,\"y2\":1,\"weight\":64,\"from\":26,\"x2\":27,\"to\":27},\"edges_76:77\":{\"y1\":0,\"x1\":76,\"y2\":0,\"weight\":83,\"from\":76,\"x2\":77,\"to\":77},\"edges_114:115\":{\"y1\":1,\"x1\":114,\"y2\":1,\"weight\":18,\"from\":114,\"x2\":115,\"to\":115},\"edges_97:98\":{\"y1\":1,\"x1\":97,\"y2\":1,\"weight\":83,\"from\":97,\"x2\":98,\"to\":98},\"edges_103:104\":{\"y1\":1,\"x1\":103,\"y2\":1,\"weight\":83,\"from\":103,\"x2\":104,\"to\":104},\"edges_136:137\":{\"y1\":1,\"x1\":136,\"y2\":1,\"weight\":81,\"from\":136,\"x2\":137,\"to\":137},\"edges_125:126\":{\"y1\":1,\"x1\":125,\"y2\":1,\"weight\":29,\"from\":125,\"x2\":126,\"to\":126},\"edges_169:170\":{\"y1\":0,\"x1\":169,\"y2\":0,\"weight\":72,\"from\":169,\"x2\":170,\"to\":170},\"edges_38:39\":{\"y1\":1,\"x1\":38,\"y2\":1,\"weight\":81,\"from\":38,\"x2\":39,\"to\":39},\"edges_107:117\":{\"y1\":1,\"x1\":107,\"y2\":1,\"weight\":5,\"from\":107,\"x2\":117,\"to\":117},\"edges_86:87\":{\"y1\":1,\"x1\":86,\"y2\":1,\"weight\":83,\"from\":86,\"x2\":87,\"to\":87},\"edges_158:159\":{\"y1\":0,\"x1\":158,\"y2\":0,\"weight\":72,\"from\":158,\"x2\":159,\"to\":159},\"edges_147:148\":{\"y1\":1,\"x1\":147,\"y2\":1,\"weight\":18,\"from\":147,\"x2\":148,\"to\":148},\"edges_65:66\":{\"y1\":1,\"x1\":65,\"y2\":1,\"weight\":45,\"from\":65,\"x2\":66,\"to\":66},\"edges_107:115\":{\"y1\":1,\"x1\":107,\"y2\":1,\"weight\":2,\"from\":107,\"x2\":115,\"to\":115},\"edges_48:49\":{\"y1\":1,\"x1\":48,\"y2\":1,\"weight\":70,\"from\":48,\"x2\":49,\"to\":49},\"edges_27:28\":{\"y1\":1,\"x1\":27,\"y2\":1,\"weight\":70,\"from\":27,\"x2\":28,\"to\":28},\"edges_54:55\":{\"y1\":1,\"x1\":54,\"y2\":1,\"weight\":81,\"from\":54,\"x2\":55,\"to\":55},\"edges_197:198\":{\"y1\":0,\"x1\":197,\"y2\":0,\"weight\":64,\"from\":197,\"x2\":198,\"to\":198},\"edges_186:187\":{\"y1\":1,\"x1\":186,\"y2\":1,\"weight\":8,\"from\":186,\"x2\":187,\"to\":187},\"edges_164:165\":{\"y1\":0,\"x1\":164,\"y2\":0,\"weight\":72,\"from\":164,\"x2\":165,\"to\":165},\"edges_16:17\":{\"y1\":0,\"x1\":16,\"y2\":0,\"weight\":18,\"from\":16,\"x2\":17,\"to\":17},\"edges_108:131\":{\"y1\":1,\"x1\":108,\"y2\":1,\"weight\":13,\"from\":108,\"x2\":131,\"to\":131},\"edges_175:176\":{\"y1\":0,\"x1\":175,\"y2\":1,\"weight\":64,\"from\":175,\"x2\":176,\"to\":176},\"edges_153:154\":{\"y1\":0,\"x1\":153,\"y2\":0,\"weight\":86,\"from\":153,\"x2\":154,\"to\":154},\"edges_43:47\":{\"y1\":1,\"x1\":43,\"y2\":1,\"weight\":2,\"from\":43,\"x2\":47,\"to\":47},\"edges_107:108\":{\"y1\":1,\"x1\":107,\"y2\":1,\"weight\":59,\"from\":107,\"x2\":108,\"to\":108},\"edges_43:44\":{\"y1\":1,\"x1\":43,\"y2\":1,\"weight\":78,\"from\":43,\"x2\":44,\"to\":44},\"edges_142:143\":{\"y1\":1,\"x1\":142,\"y2\":1,\"weight\":2,\"from\":142,\"x2\":143,\"to\":143},\"edges_120:121\":{\"y1\":1,\"x1\":120,\"y2\":1,\"weight\":56,\"from\":120,\"x2\":121,\"to\":121},\"edges_6:7\":{\"y1\":1,\"x1\":6,\"y2\":1,\"weight\":29,\"from\":6,\"x2\":7,\"to\":7},\"edges_120:124\":{\"y1\":1,\"x1\":120,\"y2\":1,\"weight\":13,\"from\":120,\"x2\":124,\"to\":124},\"edges_131:132\":{\"y1\":1,\"x1\":131,\"y2\":1,\"weight\":83,\"from\":131,\"x2\":132,\"to\":132},\"edges_9:10\":{\"y1\":1,\"x1\":9,\"y2\":1,\"weight\":35,\"from\":9,\"x2\":10,\"to\":10},\"edges_59:60\":{\"y1\":1,\"x1\":59,\"y2\":1,\"weight\":78,\"from\":59,\"x2\":60,\"to\":60},\"edges_92:93\":{\"y1\":1,\"x1\":92,\"y2\":1,\"weight\":16,\"from\":92,\"x2\":93,\"to\":93},\"edges_70:71\":{\"y1\":0,\"x1\":70,\"y2\":0,\"weight\":91,\"from\":70,\"x2\":71,\"to\":71},\"edges_186:190\":{\"y1\":1,\"x1\":186,\"y2\":0,\"weight\":37,\"from\":186,\"x2\":190,\"to\":190},\"edges_130:131\":{\"y1\":1,\"x1\":130,\"y2\":1,\"weight\":70,\"from\":130,\"x2\":131,\"to\":131},\"edges_186:191\":{\"y1\":1,\"x1\":186,\"y2\":0,\"weight\":8,\"from\":186,\"x2\":191,\"to\":191},\"edges_53:54\":{\"y1\":1,\"x1\":53,\"y2\":1,\"weight\":81,\"from\":53,\"x2\":54,\"to\":54},\"edges_2:14\":{\"y1\":0,\"x1\":2,\"y2\":0,\"weight\":2,\"from\":2,\"x2\":14,\"to\":14},\"edges_19:20\":{\"y1\":1,\"x1\":19,\"y2\":1,\"weight\":16,\"from\":19,\"x2\":20,\"to\":20},\"edges_36:37\":{\"y1\":1,\"x1\":36,\"y2\":1,\"weight\":78,\"from\":36,\"x2\":37,\"to\":37},\"edges_162:163\":{\"y1\":1,\"x1\":162,\"y2\":1,\"weight\":8,\"from\":162,\"x2\":163,\"to\":163},\"edges_13:34\":{\"y1\":1,\"x1\":13,\"y2\":1,\"weight\":5,\"from\":13,\"x2\":34,\"to\":34},\"edges_81:82\":{\"y1\":1,\"x1\":81,\"y2\":0,\"weight\":81,\"from\":81,\"x2\":82,\"to\":82},\"edges_13:31\":{\"y1\":1,\"x1\":13,\"y2\":1,\"weight\":2,\"from\":13,\"x2\":31,\"to\":31},\"edges_150:151\":{\"y1\":0,\"x1\":150,\"y2\":0,\"weight\":86,\"from\":150,\"x2\":151,\"to\":151},\"edges_42:43\":{\"y1\":1,\"x1\":42,\"y2\":1,\"weight\":81,\"from\":42,\"x2\":43,\"to\":43},\"edges_134:148\":{\"y1\":1,\"x1\":134,\"y2\":1,\"weight\":2,\"from\":134,\"x2\":148,\"to\":148},\"edges_199:200\":{\"y1\":0,\"x1\":199,\"y2\":0,\"weight\":45,\"from\":199,\"x2\":200,\"to\":200},\"edges_194:195\":{\"y1\":0,\"x1\":194,\"y2\":0,\"weight\":67,\"from\":194,\"x2\":195,\"to\":195},\"edges_202:203\":{\"y1\":0,\"x1\":202,\"y2\":0,\"weight\":5,\"from\":202,\"x2\":203,\"to\":203},\"edges_25:26\":{\"y1\":1,\"x1\":25,\"y2\":1,\"weight\":54,\"from\":25,\"x2\":26,\"to\":26},\"edges_122:123\":{\"y1\":1,\"x1\":122,\"y2\":2,\"weight\":2,\"from\":122,\"x2\":123,\"to\":123},\"edges_129:130\":{\"y1\":1,\"x1\":129,\"y2\":1,\"weight\":70,\"from\":129,\"x2\":130,\"to\":130},\"edges_69:70\":{\"y1\":0,\"x1\":69,\"y2\":0,\"weight\":91,\"from\":69,\"x2\":70,\"to\":70},\"edges_75:76\":{\"y1\":1,\"x1\":75,\"y2\":0,\"weight\":83,\"from\":75,\"x2\":76,\"to\":76},\"edges_122:124\":{\"y1\":1,\"x1\":122,\"y2\":1,\"weight\":13,\"from\":122,\"x2\":124,\"to\":124},\"edges_98:99\":{\"y1\":1,\"x1\":98,\"y2\":1,\"weight\":83,\"from\":98,\"x2\":99,\"to\":99},\"edges_122:128\":{\"y1\":1,\"x1\":122,\"y2\":1,\"weight\":37,\"from\":122,\"x2\":128,\"to\":128},\"edges_182:183\":{\"y1\":0,\"x1\":182,\"y2\":0,\"weight\":72,\"from\":182,\"x2\":183,\"to\":183},\"edges_14:15\":{\"y1\":0,\"x1\":14,\"y2\":0,\"weight\":18,\"from\":14,\"x2\":15,\"to\":15},\"edges_166:167\":{\"y1\":0,\"x1\":166,\"y2\":2,\"weight\":70,\"from\":166,\"x2\":167,\"to\":167},\"edges_166:168\":{\"y1\":0,\"x1\":166,\"y2\":0,\"weight\":2,\"from\":166,\"x2\":168,\"to\":168},\"edges_87:88\":{\"y1\":1,\"x1\":87,\"y2\":1,\"weight\":86,\"from\":87,\"x2\":88,\"to\":88},\"edges_102:103\":{\"y1\":1,\"x1\":102,\"y2\":1,\"weight\":83,\"from\":102,\"x2\":103,\"to\":103},\"edges_134:135\":{\"y1\":1,\"x1\":134,\"y2\":1,\"weight\":81,\"from\":134,\"x2\":135,\"to\":135},\"edges_3:4\":{\"y1\":2,\"x1\":3,\"y2\":1,\"weight\":8,\"from\":3,\"x2\":4,\"to\":4},\"edges_64:65\":{\"y1\":1,\"x1\":64,\"y2\":1,\"weight\":32,\"from\":64,\"x2\":65,\"to\":65},\"edges_3:9\":{\"y1\":2,\"x1\":3,\"y2\":1,\"weight\":10,\"from\":3,\"x2\":9,\"to\":9},\"edges_109:110\":{\"y1\":1,\"x1\":109,\"y2\":1,\"weight\":2,\"from\":109,\"x2\":110,\"to\":110},\"edges_170:171\":{\"y1\":0,\"x1\":170,\"y2\":0,\"weight\":72,\"from\":170,\"x2\":171,\"to\":171},\"edges_178:179\":{\"y1\":1,\"x1\":178,\"y2\":1,\"weight\":70,\"from\":178,\"x2\":179,\"to\":179},\"edges_157:158\":{\"y1\":0,\"x1\":157,\"y2\":0,\"weight\":72,\"from\":157,\"x2\":158,\"to\":158},\"edges_106:115\":{\"y1\":0,\"x1\":106,\"y2\":1,\"weight\":5,\"from\":106,\"x2\":115,\"to\":115},\"edges_146:147\":{\"y1\":2,\"x1\":146,\"y2\":1,\"weight\":5,\"from\":146,\"x2\":147,\"to\":147},\"edges_126:127\":{\"y1\":1,\"x1\":126,\"y2\":1,\"weight\":21,\"from\":126,\"x2\":127,\"to\":127},\"edges_126:129\":{\"y1\":1,\"x1\":126,\"y2\":1,\"weight\":8,\"from\":126,\"x2\":129,\"to\":129},\"edges_18:68\":{\"y1\":0,\"x1\":18,\"y2\":0,\"weight\":2,\"from\":18,\"x2\":68,\"to\":68},\"edges_137:138\":{\"y1\":1,\"x1\":137,\"y2\":1,\"weight\":81,\"from\":137,\"x2\":138,\"to\":138},\"edges_18:63\":{\"y1\":0,\"x1\":18,\"y2\":1,\"weight\":2,\"from\":18,\"x2\":63,\"to\":63},\"edges_198:199\":{\"y1\":0,\"x1\":198,\"y2\":0,\"weight\":59,\"from\":198,\"x2\":199,\"to\":199},\"edges_93:94\":{\"y1\":1,\"x1\":93,\"y2\":1,\"weight\":16,\"from\":93,\"x2\":94,\"to\":94},\"edges_165:166\":{\"y1\":0,\"x1\":165,\"y2\":0,\"weight\":72,\"from\":165,\"x2\":166,\"to\":166},\"edges_106:108\":{\"y1\":0,\"x1\":106,\"y2\":1,\"weight\":2,\"from\":106,\"x2\":108,\"to\":108},\"edges_106:107\":{\"y1\":0,\"x1\":106,\"y2\":1,\"weight\":67,\"from\":106,\"x2\":107,\"to\":107},\"edges_154:155\":{\"y1\":0,\"x1\":154,\"y2\":0,\"weight\":86,\"from\":154,\"x2\":155,\"to\":155},\"edges_31:32\":{\"y1\":1,\"x1\":31,\"y2\":1,\"weight\":72,\"from\":31,\"x2\":32,\"to\":32},\"edges_58:59\":{\"y1\":1,\"x1\":58,\"y2\":1,\"weight\":78,\"from\":58,\"x2\":59,\"to\":59},\"edges_80:83\":{\"y1\":1,\"x1\":80,\"y2\":1,\"weight\":2,\"from\":80,\"x2\":83,\"to\":83},\"edges_80:81\":{\"y1\":1,\"x1\":80,\"y2\":1,\"weight\":70,\"from\":80,\"x2\":81,\"to\":81},\"edges_121:122\":{\"y1\":1,\"x1\":121,\"y2\":1,\"weight\":54,\"from\":121,\"x2\":122,\"to\":122},\"edges_13:63\":{\"y1\":1,\"x1\":13,\"y2\":1,\"weight\":2,\"from\":13,\"x2\":63,\"to\":63},\"edges_110:111\":{\"y1\":1,\"x1\":110,\"y2\":1,\"weight\":2,\"from\":110,\"x2\":111,\"to\":111},\"edges_4:5\":{\"y1\":1,\"x1\":4,\"y2\":1,\"weight\":29,\"from\":4,\"x2\":5,\"to\":5},\"edges_20:21\":{\"y1\":1,\"x1\":20,\"y2\":1,\"weight\":16,\"from\":20,\"x2\":21,\"to\":21},\"edges_174:178\":{\"y1\":1,\"x1\":174,\"y2\":1,\"weight\":2,\"from\":174,\"x2\":178,\"to\":178},\"edges_82:106\":{\"y1\":0,\"x1\":82,\"y2\":0,\"weight\":2,\"from\":82,\"x2\":106,\"to\":106},\"edges_47:48\":{\"y1\":1,\"x1\":47,\"y2\":1,\"weight\":62,\"from\":47,\"x2\":48,\"to\":48},\"edges_185:186\":{\"y1\":0,\"x1\":185,\"y2\":1,\"weight\":54,\"from\":185,\"x2\":186,\"to\":186},\"edges_117:118\":{\"y1\":1,\"x1\":117,\"y2\":1,\"weight\":62,\"from\":117,\"x2\":118,\"to\":118},\"edges_174:175\":{\"y1\":1,\"x1\":174,\"y2\":0,\"weight\":29,\"from\":174,\"x2\":175,\"to\":175},\"edges_74:75\":{\"y1\":0,\"x1\":74,\"y2\":1,\"weight\":89,\"from\":74,\"x2\":75,\"to\":75},\"edges_74:76\":{\"y1\":0,\"x1\":74,\"y2\":0,\"weight\":2,\"from\":74,\"x2\":76,\"to\":76},\"edges_195:196\":{\"y1\":0,\"x1\":195,\"y2\":0,\"weight\":67,\"from\":195,\"x2\":196,\"to\":196},\"edges_57:58\":{\"y1\":1,\"x1\":57,\"y2\":1,\"weight\":78,\"from\":57,\"x2\":58,\"to\":58},\"edges_151:152\":{\"y1\":0,\"x1\":151,\"y2\":0,\"weight\":86,\"from\":151,\"x2\":152,\"to\":152},\"edges_201:202\":{\"y1\":0,\"x1\":201,\"y2\":0,\"weight\":16,\"from\":201,\"x2\":202,\"to\":202},\"edges_101:115\":{\"y1\":1,\"x1\":101,\"y2\":1,\"weight\":2,\"from\":101,\"x2\":115,\"to\":115},\"edges_173:174\":{\"y1\":1,\"x1\":173,\"y2\":1,\"weight\":29,\"from\":173,\"x2\":174,\"to\":174},\"edges_0:1\":{\"y1\":0,\"x1\":0,\"y2\":0,\"weight\":29,\"from\":0,\"x2\":1,\"to\":1},\"edges_88:89\":{\"y1\":1,\"x1\":88,\"y2\":1,\"weight\":83,\"from\":88,\"x2\":89,\"to\":89},\"edges_79:80\":{\"y1\":1,\"x1\":79,\"y2\":1,\"weight\":2,\"from\":79,\"x2\":80,\"to\":80},\"edges_161:162\":{\"y1\":1,\"x1\":161,\"y2\":1,\"weight\":8,\"from\":161,\"x2\":162,\"to\":162},\"edges_185:190\":{\"y1\":0,\"x1\":185,\"y2\":0,\"weight\":13,\"from\":185,\"x2\":190,\"to\":190},\"edges_63:64\":{\"y1\":1,\"x1\":63,\"y2\":1,\"weight\":32,\"from\":63,\"x2\":64,\"to\":64},\"edges_46:47\":{\"y1\":1,\"x1\":46,\"y2\":1,\"weight\":59,\"from\":46,\"x2\":47,\"to\":47},\"edges_111:112\":{\"y1\":1,\"x1\":111,\"y2\":1,\"weight\":2,\"from\":111,\"x2\":112,\"to\":112},\"edges_161:164\":{\"y1\":1,\"x1\":161,\"y2\":0,\"weight\":56,\"from\":161,\"x2\":164,\"to\":164},\"edges_183:184\":{\"y1\":0,\"x1\":183,\"y2\":0,\"weight\":72,\"from\":183,\"x2\":184,\"to\":184},\"edges_46:50\":{\"y1\":1,\"x1\":46,\"y2\":1,\"weight\":10,\"from\":46,\"x2\":50,\"to\":50},\"edges_133:134\":{\"y1\":1,\"x1\":133,\"y2\":1,\"weight\":83,\"from\":133,\"x2\":134,\"to\":134},\"edges_52:53\":{\"y1\":1,\"x1\":52,\"y2\":1,\"weight\":81,\"from\":52,\"x2\":53,\"to\":53},\"edges_155:157\":{\"y1\":0,\"x1\":155,\"y2\":0,\"weight\":2,\"from\":155,\"x2\":157,\"to\":157},\"edges_155:156\":{\"y1\":0,\"x1\":155,\"y2\":2,\"weight\":83,\"from\":155,\"x2\":156,\"to\":156},\"edges_88:90\":{\"y1\":1,\"x1\":88,\"y2\":1,\"weight\":2,\"from\":88,\"x2\":90,\"to\":90},\"edges_101:102\":{\"y1\":1,\"x1\":101,\"y2\":1,\"weight\":83,\"from\":101,\"x2\":102,\"to\":102},\"edges_123:124\":{\"y1\":2,\"x1\":123,\"y2\":1,\"weight\":2,\"from\":123,\"x2\":124,\"to\":124},\"edges_177:178\":{\"y1\":1,\"x1\":177,\"y2\":1,\"weight\":67,\"from\":177,\"x2\":178,\"to\":178},\"edges_145:148\":{\"y1\":1,\"x1\":145,\"y2\":1,\"weight\":2,\"from\":145,\"x2\":148,\"to\":148},\"edges_1:2\":{\"y1\":0,\"x1\":1,\"y2\":0,\"weight\":35,\"from\":1,\"x2\":2,\"to\":2},\"edges_145:149\":{\"y1\":1,\"x1\":145,\"y2\":1,\"weight\":43,\"from\":145,\"x2\":149,\"to\":149},\"edges_83:84\":{\"y1\":1,\"x1\":83,\"y2\":1,\"weight\":81,\"from\":83,\"x2\":84,\"to\":84},\"edges_99:100\":{\"y1\":1,\"x1\":99,\"y2\":1,\"weight\":86,\"from\":99,\"x2\":100,\"to\":100},\"edges_68:69\":{\"y1\":0,\"x1\":68,\"y2\":0,\"weight\":91,\"from\":68,\"x2\":69,\"to\":69},\"edges_191:192\":{\"y1\":0,\"x1\":191,\"y2\":0,\"weight\":67,\"from\":191,\"x2\":192,\"to\":192},\"edges_41:42\":{\"y1\":1,\"x1\":41,\"y2\":1,\"weight\":81,\"from\":41,\"x2\":42,\"to\":42},\"edges_145:146\":{\"y1\":1,\"x1\":145,\"y2\":2,\"weight\":5,\"from\":145,\"x2\":146,\"to\":146},\"edges_145:147\":{\"y1\":1,\"x1\":145,\"y2\":1,\"weight\":8,\"from\":145,\"x2\":147,\"to\":147},\"edges_167:168\":{\"y1\":2,\"x1\":167,\"y2\":0,\"weight\":70,\"from\":167,\"x2\":168,\"to\":168},\"edges_94:95\":{\"y1\":1,\"x1\":94,\"y2\":1,\"weight\":16,\"from\":94,\"x2\":95,\"to\":95},\"edges_57:61\":{\"y1\":1,\"x1\":57,\"y2\":1,\"weight\":2,\"from\":57,\"x2\":61,\"to\":61},\"edges_23:37\":{\"y1\":1,\"x1\":23,\"y2\":1,\"weight\":2,\"from\":23,\"x2\":37,\"to\":37},\"edges_138:149\":{\"y1\":1,\"x1\":138,\"y2\":1,\"weight\":2,\"from\":138,\"x2\":149,\"to\":149},\"edges_23:63\":{\"y1\":1,\"x1\":23,\"y2\":1,\"weight\":8,\"from\":23,\"x2\":63,\"to\":63},\"edges_51:52\":{\"y1\":1,\"x1\":51,\"y2\":1,\"weight\":81,\"from\":51,\"x2\":52,\"to\":52},\"edges_30:31\":{\"y1\":1,\"x1\":30,\"y2\":1,\"weight\":70,\"from\":30,\"x2\":31,\"to\":31},\"edges_138:145\":{\"y1\":1,\"x1\":138,\"y2\":1,\"weight\":5,\"from\":138,\"x2\":145,\"to\":145},\"edges_106:150\":{\"y1\":0,\"x1\":106,\"y2\":0,\"weight\":2,\"from\":106,\"x2\":150,\"to\":150},\"edges_18:26\":{\"y1\":0,\"x1\":18,\"y2\":1,\"weight\":2,\"from\":18,\"x2\":26,\"to\":26},\"edges_18:24\":{\"y1\":0,\"x1\":18,\"y2\":1,\"weight\":8,\"from\":18,\"x2\":24,\"to\":24},\"edges_40:41\":{\"y1\":1,\"x1\":40,\"y2\":1,\"weight\":81,\"from\":40,\"x2\":41,\"to\":41},\"edges_189:190\":{\"y1\":1,\"x1\":189,\"y2\":0,\"weight\":8,\"from\":189,\"x2\":190,\"to\":190},\"edges_190:191\":{\"y1\":0,\"x1\":190,\"y2\":0,\"weight\":59,\"from\":190,\"x2\":191,\"to\":191},\"edges_73:74\":{\"y1\":0,\"x1\":73,\"y2\":0,\"weight\":91,\"from\":73,\"x2\":74,\"to\":74},\"edges_138:139\":{\"y1\":1,\"x1\":138,\"y2\":1,\"weight\":72,\"from\":138,\"x2\":139,\"to\":139},\"edges_35:36\":{\"y1\":2,\"x1\":35,\"y2\":1,\"weight\":59,\"from\":35,\"x2\":36,\"to\":36},\"edges_116:119\":{\"y1\":2,\"x1\":116,\"y2\":1,\"weight\":2,\"from\":116,\"x2\":119,\"to\":119},\"edges_29:30\":{\"y1\":1,\"x1\":29,\"y2\":1,\"weight\":70,\"from\":29,\"x2\":30,\"to\":30},\"edges_105:106\":{\"y1\":1,\"x1\":105,\"y2\":0,\"weight\":75,\"from\":105,\"x2\":106,\"to\":106},\"edges_13:24\":{\"y1\":1,\"x1\":13,\"y2\":1,\"weight\":18,\"from\":13,\"x2\":24,\"to\":24},\"edges_127:128\":{\"y1\":1,\"x1\":127,\"y2\":1,\"weight\":24,\"from\":127,\"x2\":128,\"to\":128},\"edges_13:26\":{\"y1\":1,\"x1\":13,\"y2\":1,\"weight\":5,\"from\":13,\"x2\":26,\"to\":26},\"edges_116:117\":{\"y1\":2,\"x1\":116,\"y2\":1,\"weight\":51,\"from\":116,\"x2\":117,\"to\":117},\"edges_116:118\":{\"y1\":2,\"x1\":116,\"y2\":1,\"weight\":8,\"from\":116,\"x2\":118,\"to\":118},\"edges_62:63\":{\"y1\":1,\"x1\":62,\"y2\":1,\"weight\":18,\"from\":62,\"x2\":63,\"to\":63},\"edges_2:4\":{\"y1\":0,\"x1\":2,\"y2\":1,\"weight\":16,\"from\":2,\"x2\":4,\"to\":4},\"edges_2:3\":{\"y1\":0,\"x1\":2,\"y2\":2,\"weight\":16,\"from\":2,\"x2\":3,\"to\":3},\"edges_149:150\":{\"y1\":1,\"x1\":149,\"y2\":0,\"weight\":83,\"from\":149,\"x2\":150,\"to\":150},\"edges_2:9\":{\"y1\":0,\"x1\":2,\"y2\":1,\"weight\":8,\"from\":2,\"x2\":9,\"to\":9},\"edges_78:80\":{\"y1\":1,\"x1\":78,\"y2\":1,\"weight\":5,\"from\":78,\"x2\":80,\"to\":80},\"edges_24:25\":{\"y1\":1,\"x1\":24,\"y2\":1,\"weight\":51,\"from\":24,\"x2\":25,\"to\":25}}}\n");

            // add msa and inferred ancestral graph
            String graphs = asr.catGraphJSONBuilder(asr.getMSAGraphJSON(), asr.getAncestralGraphJSON(asr.getInferenceType(), "root"));


            model.addAttribute("graph", graphs);

        } catch (Exception e) {
            model.addAttribute("error", true);
            model.addAttribute("errorMessage", e.getMessage());
            System.out.println("Error: " + e.getMessage());
            return "index";
        }

        // add attribute to specify to view results (i.e. to show the graph, tree, etc)
        model.addAttribute("inferenceType", asr.getInferenceType());
        model.addAttribute("results", true);

        return "index";
    }

    /**
     * Perform marginal reconstruction of specified tree node.
     *
     * @param infer inference type (Expects marginal)
     * @param node  node label
     * @param model com model
     * @return index view
     */
    @RequestMapping(method = RequestMethod.POST, params = {"infer", "node"})
    @ResponseBody
    public String performReconstruction(@RequestParam String infer, @RequestParam String node, Model model) {

        System.out.println("infer,node");
        model.addAttribute("results", true);

        // TODO: push exceptions to error message on view...
        try {
            asr.setInferenceType(infer);

            if (infer.equalsIgnoreCase("marginal")) {
                asr.setMarginalNodeLabel(node);
                asr.runReconstruction();
            }

            // add reconstructed newick string to send to javascript
            model.addAttribute("tree", asr.getReconstructedNewickString());

        } catch (Exception e) {
            model.addAttribute("error", true);
            model.addAttribute("errorMessage", e.getMessage());
            System.out.println("Error: " + e.getMessage());
            return "index";
        }
        // add msa and inferred ancestral graph
        String graphs = asr.catGraphJSONBuilder(asr.getMSAGraphJSON(), asr.getAncestralGraphJSON(infer, node));

        model.addAttribute("graph", graphs);
        model.addAttribute("inferenceType", asr.getInferenceType());

        // add attribute to specify to view results (i.e. to show the graph, tree, etc)
        return graphs;

    }

    /**
     * Download files from reconstruction
     *
     * @param request   HTTP request (form request specifying parameters)
     * @param response  HTTP response to send data to client
     * @throws IOException
     */
    @RequestMapping(method = RequestMethod.GET, params = "download")
    public void showForm(HttpServletRequest request, HttpServletResponse response) throws IOException {
        
        response.setHeader("Content-Type", "application/zip");
        response.setHeader("Content-Disposition", "attachment; filename=GRASP_" + asr.getLabel() + ".zip");

        // create temporary folder to send output as zipped files
        String tempDir = asr.getSessionDir() + "/GRASP_" + asr.getLabel();
        File sessionDir = new File(tempDir);
        if (sessionDir.exists()) {
            for (File file : sessionDir.listFiles())
                file.delete();
            sessionDir.delete();
        }
        sessionDir.mkdir();

        // copy output files to temporary folder, or generate output where needed and save in temporary folder
        String jointPath = tempDir + "/Joint_reconstruction";
        String marginalPath = tempDir + "/Marginal_reconstruction";
        if (request.getParameter("check-recon-tree") != null && request.getParameter("check-recon-tree").equalsIgnoreCase("on"))
            Files.copy((new File(asr.getSessionDir() + asr.getReconstructedTreeFileName())).toPath(),
                    (new File(tempDir + "/" + asr.getReconstructedTreeFileName())).toPath(), StandardCopyOption.REPLACE_EXISTING);
        if (request.getParameter("check-pog-msa") != null && request.getParameter("check-pog-msa").equalsIgnoreCase("on"))
            asr.saveMSA(tempDir + "/");
        if (request.getParameter("check-pog-marg") != null && request.getParameter("check-pog-marg").equalsIgnoreCase("on")) {
            File marginalDir = new File(marginalPath);
            if (!marginalDir.exists())
                marginalDir.mkdir();
            asr.saveAncestorGraph(request.getParameter("marg-node"), marginalPath + "/");
        }
        if (request.getParameter("check-marg-dist") != null && request.getParameter("check-marg-dist").equalsIgnoreCase("on")) {
            File marginalDir = new File(marginalPath);
            if (!marginalDir.exists())
                marginalDir.mkdir();
            asr.saveMarginalDistribution(marginalPath + "/" + request.getParameter("marg-node"));
        }
        if (request.getParameter("check-pog-joint") != null && request.getParameter("check-pog-joint").equalsIgnoreCase("on")) {
            File jointDir = new File(jointPath);
            if (!jointDir.exists())
                jointDir.mkdir();
            asr.saveAncestors(jointPath + "/");
        }
        if (request.getParameter("check-seq-marg") != null && request.getParameter("check-seq-marg").equalsIgnoreCase("on")) {
            File marginalDir = new File(marginalPath);
            if (!marginalDir.exists())
                marginalDir.mkdir();
            asr.saveConsensusMarginal(marginalPath + "/" + request.getParameter("marg-node") + "_consensus");
        }
        if (request.getParameter("check-seq-joint") != null && request.getParameter("check-seq-joint").equalsIgnoreCase("on")) {
            File jointDir = new File(jointPath);
            if (!jointDir.exists())
                jointDir.mkdir();
            asr.saveConsensusJoint(jointPath + "/ancestors_consensus");
        }

        //asr.saveMSAImage(tempDir + "/MSA.png");

        // send output folder to client
        zipFolder(sessionDir, response.getOutputStream());

    }

    /**
     * Helper functions to zip files/directories
     **/

    private  void zipFolder(final File folder, final File zipFile) throws IOException {
        zipFolder(folder, new FileOutputStream(zipFile));
    }

    private  void zipFolder(final File folder, final OutputStream outputStream) throws IOException {
        ZipOutputStream zipOutputStream = new ZipOutputStream(outputStream);
        processFolder(folder, zipOutputStream, folder.getPath().length() + 1);
    }

    private  void processFolder(final File folder, final ZipOutputStream zos, final int prefixLength)
            throws IOException {
        for (final File file : folder.listFiles()) {
            if (file.isFile()) {
                final ZipEntry zipEntry = new ZipEntry(file.getPath().substring(prefixLength));
                zos.putNextEntry(zipEntry);
                FileInputStream fis = new FileInputStream(file);
                IOUtils.copy(fis, zos);
                zos.closeEntry();
                fis.close();
            } else if (file.isDirectory()) {
                processFolder(file, zos, prefixLength);
            }
        }
    }
}