<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="form">
    <a name="reconstruct"></a>
    <div class="content-section-a" th:if="${results == null and error == null}">
        <div th:replace="fragments/help :: help"></div>
        <div class="container-fluid">
            <form class="col-sm-offset-2 col-md-offset-2 col-lg-offset-2 col-md-10 col-lg-10" action="#" name="asrForm" th:action="@{/asr}" th:object="${asrForm}" method="post" enctype="multipart/form-data">
                <div class="form-group row col-md-offset-1 col-lg-offset-1 col-md-8 col-lg-8">
                    <div class="input-group">
                        <input type="text" class="form-control col-sm-6 col-md-6 col-lg-6" placeholder="Label your reconstruction..." id="label" name="label" th:field="*{label}" />
                        <span class="input-group-btn">
                            <button type="submit" name="test" class="btn btn-default">Run Test Data</button>
                        </span>
                    </div>
                    <div class="form-group has-error" th:if="${#fields.hasErrors('label')}"><label class="control-label" for="label" th:errors="*{label}"></label></div>
                </div>
                <div class="form-group row col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8">
                    <fieldset>
                        <legend>
                            Align extant sequences
                            <div class="material-switch pull-right">
                                <input id="check-align" type="checkbox" />
                                <label for="check-align" class="label-primary"></label>
                            </div>
                        </legend>
                        <div class="input-group" id="seq-input">
                            <span class="input-group-addon glyphicon glyphicon-align-left" aria-hidden="true"></span>
                            <label id="lbl-fileseq" class="btn btn-default col-md-9 col-sm-9 col-lg-9" disabled="true" for="fileseq">
                                Select sequence library file...
                                <input type="file" name="fileseq" id="fileseq" disabled="true" style="display:none;" onchange="$('#upload-seq-info').html(document.forms['asrForm']['fileseq'].files[0].name);" hidden="hidden" th:field="*{seqFile}"></input>
                            </label>&nbsp;
                            <span class="label label-default upload-file-info" id="upload-seq-info"></span>
                        </div>
                        <script type="text/javascript">
                            $('#check-align').click(function() {
                                if ($(this).is(':checked')) {
                                    // enable sequence library inputs
                                    $('#lbl-fileseq').removeAttr('disabled');
                                    $('#fileseq').removeAttr('disabled');
                                    // disable sequence alignment inputs
                                    $('#lbl-filealn').attr('disabled', true);
                                    $('#filealn').attr('disabled', true);
                                } else {
                                    // enable sequence alignment inputs
                                    $('#lbl-filealn').removeAttr('disabled');
                                    $('#filealn').removeAttr('disabled');
                                    // disable sequence library inputs
                                    $('#lbl-fileseq').attr('disabled', true);
                                    $('#fileseq').attr('disabled', true);
                                }
                            });
                        </script>
                        <div class="form-group has-error" th:if="${#fields.hasErrors('seqFile')}" th:errors="*{seqFile}"></div>
                    </fieldset>
                </div>
                <div class="form-group row col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8">
                    <div class="input-group ">
                        <span class="input-group-addon glyphicon glyphicon-align-justify" aria-hidden="true"></span>
                        <label id="lbl-filealn" class="btn btn-default col-md-9 col-sm-9 col-lg-9" for="filealn">
                            Select sequence alignment file...
                            <input type="file" name="alnFile" id="filealn" style="display:none;" onchange="$('#upload-aln-info').html(document.forms['asrForm']['alnFile'].files[0].name);" hidden="hidden" th:field="*{alnFile}"></input>
                        </label>&nbsp;
                        <span class="label label-default upload-file-info" id="upload-aln-info"></span>
                    </div>
                    <div class="form-group has-error" th:if="${#fields.hasErrors('alnFile')}"><label class="control-label" for="label" th:errors="*{alnFile}"></label></div>
                </div>
                <div class="form-group row col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8">
                    <div class="input-group">
                        <span class="input-group-addon glyphicon glyphicon-tree-conifer" aria-hidden="true"></span>
                        <label class="btn btn-default col-sm-9 col-md-9 col-lg-9" for="filetree">
                            Select phylogenetic tree file...
                            <input type="file" name="filetree" id="filetree" style="display:none;" onchange="$('#upload-tree-info').html(document.forms['asrForm']['filetree'].files[0].name);" hidden="hidden" th:field="*{treeFile}"></input>
                        </label>&nbsp;
                        <span class="label label-default upload-file-info" id="upload-tree-info"></span>
                    </div>
                    <div class="form-group has-error" th:if="${#fields.hasErrors('treeFile')}"><label class="control-label" for="label" th:errors="*{treeFile}"></label></div>
                </div>
                <div class="form-group row col-md-offset-2 col-lg-offset-2 col-md-8 col-lg-8">
                    <fieldset>
                        <legend>
                            <div class="input-group pull-right col-md-5 col-lg-5">
                                <div id="recon-radio" class="btn-group col-md-12 col-lg-12">
                                    <a id="recon-joint" class="btn btn-primary btn-m active col-md-6 col-lg-6" data-title="joint">Joint</a>
                                    <a id="recon-marg" class="btn btn-primary btn-m notActive col-md-6 col-lg-6" data-title="marginal">Marginal (root)</a>
                                    <script type="text/javascript">
                                    $('#recon-radio').click( function(){
                                        $(this).find('a').toggleClass('active').toggleClass('notActive');
                                        $('#inferenceType').val($(this).find('a.active').data('title'));
                                    });
                                    </script>
                                </div>
                                <input type="hidden" th:value="joint" th:field="*{inferenceType}" />
                            </div>
                            Initial Reconstruction
                        </legend>
                    </fieldset>
                </div>
                <div class="form-group row col-md-11 col-lg-11"><button type="submit" class="btn btn-primary col-md-3 col-sm-3 col-lg-3 pull-right" name="submit">Perform Reconstruction</button></div>
            </form>
        </div>
        <div class="form-control-feedback" th:if="${errorMessage != null}" th:text="${errorMessage}"></div>
        </div>
    </div>
</body>
</html>